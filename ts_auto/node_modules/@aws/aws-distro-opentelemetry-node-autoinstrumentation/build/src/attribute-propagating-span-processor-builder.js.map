{"version":3,"file":"attribute-propagating-span-processor-builder.js","sourceRoot":"","sources":["../../src/attribute-propagating-span-processor-builder.ts"],"names":[],"mappings":";AAAA,qEAAqE;AACrE,sCAAsC;;;AAGtC,iGAA2F;AAC3F,6DAA0D;AAC1D,yEAAmE;AAEnE;;;;GAIG;AACH,MAAa,wCAAwC;IAYnD;QAXQ,6BAAwB,GAAmC,gDAAqB,CAAC,mBAAmB,CAAC;QACrG,uBAAkB,GAAW,uCAAkB,CAAC,mBAAmB,CAAC;QACpE,8BAAyB,GAAa;YAC5C,uCAAkB,CAAC,kBAAkB;YACrC,uCAAkB,CAAC,oBAAoB;SACxC,CAAC;IAMqB,CAAC;IAJjB,MAAM,CAAC,MAAM;QAClB,OAAO,IAAI,wCAAwC,EAAE,CAAC;IACxD,CAAC;IAIM,2BAA2B,CAChC,wBAAwD;QAExD,IAAI,wBAAwB,IAAI,IAAI,EAAE;YACpC,MAAM,IAAI,KAAK,CAAC,2CAA2C,CAAC,CAAC;SAC9D;QACD,IAAI,CAAC,wBAAwB,GAAG,wBAAwB,CAAC;QACzD,OAAO,IAAI,CAAC;IACd,CAAC;IAEM,qBAAqB,CAAC,kBAA0B;QACrD,IAAI,kBAAkB,IAAI,IAAI,EAAE;YAC9B,MAAM,IAAI,KAAK,CAAC,qCAAqC,CAAC,CAAC;SACxD;QACD,IAAI,CAAC,kBAAkB,GAAG,kBAAkB,CAAC;QAC7C,OAAO,IAAI,CAAC;IACd,CAAC;IAEM,4BAA4B,CAAC,yBAAmC;QACrE,IAAI,yBAAyB,IAAI,IAAI,EAAE;YACrC,MAAM,IAAI,KAAK,CAAC,4CAA4C,CAAC,CAAC;SAC/D;QACD,IAAI,CAAC,yBAAyB,GAAG,CAAC,GAAG,yBAAyB,CAAC,CAAC;QAChE,OAAO,IAAI,CAAC;IACd,CAAC;IAEM,KAAK;QACV,OAAO,wEAAiC,CAAC,MAAM,CAC7C,IAAI,CAAC,wBAAwB,EAC7B,IAAI,CAAC,kBAAkB,EACvB,IAAI,CAAC,yBAAyB,CAC/B,CAAC;IACJ,CAAC;CACF;AA/CD,4FA+CC","sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nimport { ReadableSpan } from '@opentelemetry/sdk-trace-base';\nimport { AttributePropagatingSpanProcessor } from './attribute-propagating-span-processor';\nimport { AWS_ATTRIBUTE_KEYS } from './aws-attribute-keys';\nimport { AwsSpanProcessingUtil } from './aws-span-processing-util';\n\n/**\n * AttributePropagatingSpanProcessorBuilder is used to construct a {@link AttributePropagatingSpanProcessor}.\n * If {@link setPropagationDataExtractor}, {@link setPropagationDataKey} or {@link setAttributesKeysToPropagate}\n * are not invoked, the builder defaults to using specific propagation targets.\n */\nexport class AttributePropagatingSpanProcessorBuilder {\n  private propagationDataExtractor: (span: ReadableSpan) => string = AwsSpanProcessingUtil.getIngressOperation;\n  private propagationDataKey: string = AWS_ATTRIBUTE_KEYS.AWS_LOCAL_OPERATION;\n  private attributesKeysToPropagate: string[] = [\n    AWS_ATTRIBUTE_KEYS.AWS_REMOTE_SERVICE,\n    AWS_ATTRIBUTE_KEYS.AWS_REMOTE_OPERATION,\n  ];\n\n  public static create(): AttributePropagatingSpanProcessorBuilder {\n    return new AttributePropagatingSpanProcessorBuilder();\n  }\n\n  private constructor() {}\n\n  public setPropagationDataExtractor(\n    propagationDataExtractor: (span: ReadableSpan) => string\n  ): AttributePropagatingSpanProcessorBuilder {\n    if (propagationDataExtractor == null) {\n      throw new Error('propagationDataExtractor must not be null');\n    }\n    this.propagationDataExtractor = propagationDataExtractor;\n    return this;\n  }\n\n  public setPropagationDataKey(propagationDataKey: string): AttributePropagatingSpanProcessorBuilder {\n    if (propagationDataKey == null) {\n      throw new Error('propagationDataKey must not be null');\n    }\n    this.propagationDataKey = propagationDataKey;\n    return this;\n  }\n\n  public setAttributesKeysToPropagate(attributesKeysToPropagate: string[]): AttributePropagatingSpanProcessorBuilder {\n    if (attributesKeysToPropagate == null) {\n      throw new Error('attributesKeysToPropagate must not be null');\n    }\n    this.attributesKeysToPropagate = [...attributesKeysToPropagate];\n    return this;\n  }\n\n  public build(): AttributePropagatingSpanProcessor {\n    return AttributePropagatingSpanProcessor.create(\n      this.propagationDataExtractor,\n      this.propagationDataKey,\n      this.attributesKeysToPropagate\n    );\n  }\n}\n"]}