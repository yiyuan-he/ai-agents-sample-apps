{"version":3,"file":"remote-sampler.types.js","sourceRoot":"","sources":["../../../src/sampler/remote-sampler.types.ts"],"names":[],"mappings":";AAAA,qEAAqE;AACrE,sCAAsC","sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nimport { Resource } from '@opentelemetry/resources';\n\nexport interface AwsXRayRemoteSamplerConfig {\n  // resource to control sampling at the service level\n  resource: Resource;\n\n  // endpoint of awsproxy - for more information see https://aws-otel.github.io/docs/getting-started/remote-sampling\n  endpoint?: string;\n\n  // interval for polling sampling rules\n  pollingInterval?: number;\n}\n\n// https://docs.aws.amazon.com/xray/latest/api/API_SamplingRule.html\nexport interface ISamplingRule {\n  // A unique name for the rule\n  RuleName?: string;\n\n  // The ARN of the sampling rule\n  RuleARN?: string;\n\n  // (integer between 1 and 9999) - the priority of the sampling rule. Services evaluate rules in ascending order of\n  // priority, and make a sampling decision with the first rule that matches.\n  Priority: number;\n\n  // A fixed number of matching requests to instrument per second, before applying the fixed rate.\n  ReservoirSize: number;\n\n  // The percentage of matching requests to instrument, after the reservoir is exhausted.\n  FixedRate: number;\n\n  // The name of the instrumented service, as it appears in the X-Ray service map.\n  ServiceName: string;\n\n  // The service type, as it appears in the X-Ray service map.\n  ServiceType: string;\n\n  // The hostname from the HTTP host header.\n  Host: string;\n\n  // The method of the HTTP request.\n  HTTPMethod: string;\n\n  // the URL path of the request\n  URLPath: string;\n\n  // The ARN of the AWS resource running the service.\n  ResourceARN: string;\n\n  // Segment attributes to be matched when the sampling decision is being made.\n  Attributes?: { [key: string]: string };\n\n  Version: number;\n}\n\n// https://docs.aws.amazon.com/xray/latest/api/API_SamplingRuleRecord.html\nexport interface SamplingRuleRecord {\n  CreatedAt?: number;\n  ModifiedAt?: number;\n  SamplingRule?: ISamplingRule;\n}\n\n// https://docs.aws.amazon.com/xray/latest/api/API_GetSamplingRules.html#API_GetSamplingRules_ResponseSyntax\nexport interface GetSamplingRulesResponse {\n  NextToken?: string;\n  SamplingRuleRecords?: SamplingRuleRecord[];\n}\n\nexport interface ISamplingStatistics {\n  // RequestCount is the number of requests matched against a specific rule.\n  RequestCount: number;\n\n  // SampleCount is the number of requests sampled using a specific rule.\n  SampleCount: number;\n\n  // BorrowCount is the number of requests borrowed using a specific rule.\n  BorrowCount: number;\n}\n\n// https://docs.aws.amazon.com/xray/latest/api/API_GetSamplingTargets.html#API_GetSamplingTargets_RequestSyntax\n// SamplingStatisticsDocument is used to store current state of sampling statistics.\nexport interface SamplingStatisticsDocument {\n  // A unique identifier for the service in hexadecimal.\n  ClientID: string;\n  // The name of the sampling rule.\n  RuleName: string;\n  // The number of requests that matched the rule.\n  RequestCount: number;\n  // The number of requests borrowed using the rule.\n  BorrowCount: number;\n  // The number of requests sampled using the rule.\n  SampledCount: number;\n  // The current time.\n  Timestamp: number;\n}\n\n// https://docs.aws.amazon.com/xray/latest/api/API_GetSamplingTargets.html#API_GetSamplingTargets_RequestBody\nexport interface SamplingTargetDocument {\n  // The percentage of matching requests to instrument, after the reservoir is exhausted.\n  FixedRate: number;\n  // The number of seconds to wait before fetching sampling targets again\n  Interval?: number | null;\n  // The number of requests per second that X-Ray allocated this service.\n  ReservoirQuota?: number | null;\n  // Time when the reservoir quota will expire\n  ReservoirQuotaTTL?: number | null;\n  // The name of the sampling rule\n  RuleName: string;\n}\n\n// https://docs.aws.amazon.com/xray/latest/api/API_GetSamplingTargets.html#API_GetSamplingTargets_RequestBody\nexport interface UnprocessedStatistic {\n  ErrorCode: string;\n  Message: string;\n  RuleName: string;\n}\n\n// https://docs.aws.amazon.com/xray/latest/api/API_GetSamplingTargets.html#API_GetSamplingTargets_RequestBody\nexport interface GetSamplingTargetsBody {\n  SamplingStatisticsDocuments: SamplingStatisticsDocument[];\n}\n\n// https://docs.aws.amazon.com/xray/latest/api/API_GetSamplingTargets.html#API_GetSamplingTargets_ResponseSyntax\nexport interface GetSamplingTargetsResponse {\n  LastRuleModification: number;\n  SamplingTargetDocuments: SamplingTargetDocument[];\n  UnprocessedStatistics: UnprocessedStatistic[];\n}\n\nexport interface TargetMap {\n  [targetName: string]: SamplingTargetDocument;\n}\n"]}